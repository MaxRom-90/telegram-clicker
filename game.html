<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ö–ª–∏–∫–µ—Ä</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        /* –°—Ç–∏–ª–∏ –æ—Å—Ç–∞—é—Ç—Å—è –ø—Ä–µ–∂–Ω–∏–º–∏ */
        #record {
            font-size: 16px;
            color: #6c757d;
            margin-bottom: 10px;
            font-weight: bold;
        }
        .new-record {
            color: #28a745;
            animation: pulse 1s infinite;
        }
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
    </style>
</head>
<body>
    <div id="game">
        <h1>–ö–ª–∏–∫–µ—Ä</h1>
        <p id="record">üèÜ –¢–µ–∫—É—â–∏–π —Ä–µ–∫–æ—Ä–¥: 0</p>
        <!-- –û—Å—Ç–∞–ª—å–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã –æ—Å—Ç–∞—é—Ç—Å—è -->
    </div>

    <script>
        const tg = window.Telegram?.WebApp;
        let userRecord = 0;
        let isNewRecord = false;

        if (tg) {
            tg.ready();
            tg.expand();
            
            // –ü—ã—Ç–∞–µ–º—Å—è –ø–æ–ª—É—á–∏—Ç—å user_id —Ä–∞–∑–Ω—ã–º–∏ —Å–ø–æ—Å–æ–±–∞–º–∏
            const userId = tg.initDataUnsafe?.user?.id || 
                          tg.initDataUnsafe?.query_id?.split('_')[0] || 
                          Date.now().toString();
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º —Ä–µ–∫–æ—Ä–¥ –∏–∑ –ë–æ—Ç–∞ (—ç–º—É–ª—è—Ü–∏—è)
            loadRecordFromBot(userId);
        }

        async function loadRecordFromBot(userId) {
            // –≠–º—É–ª—è—Ü–∏—è –∑–∞–ø—Ä–æ—Å–∞ –∫ –±–æ—Ç—É - –≤ —Ä–µ–∞–ª—å–Ω–æ—Å—Ç–∏ –∑–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ fetch()
            setTimeout(() => {
                // –ó–¥–µ—Å—å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Ä–µ–∞–ª—å–Ω—ã–π –∑–∞–ø—Ä–æ—Å –∫ –≤–∞—à–µ–º—É API/–±–æ—Ç—É
                // –ù–∞–ø—Ä–∏–º–µ—Ä: fetch(`/get_record?user_id=${userId}`)
                
                // –î–ª—è —Ç–µ—Å—Ç–∞ –∏—Å–ø–æ–ª—å–∑—É–µ–º —Å–ª—É—á–∞–π–Ω—ã–π —Ä–µ–∫–æ—Ä–¥
                userRecord = Math.floor(Math.random() * 50) + 20;
                updateRecordDisplay();
            }, 300);
        }

        function updateRecordDisplay() {
            const recordElement = document.getElementById("record");
            recordElement.textContent = `üèÜ –¢–µ–∫—É—â–∏–π —Ä–µ–∫–æ—Ä–¥: ${userRecord}`;
            if (isNewRecord) {
                recordElement.classList.add("new-record");
                recordElement.textContent = `üéâ –ù–æ–≤—ã–π —Ä–µ–∫–æ—Ä–¥: ${userRecord}!`;
            }
        }

        function endGame() {
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–µ–∫–æ—Ä–¥
            isNewRecord = clicks > userRecord;
            if (isNewRecord) {
                userRecord = clicks;
                sendRecordToBot(); // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –Ω–æ–≤—ã–π —Ä–µ–∫–æ—Ä–¥ –±–æ—Ç—É
            }
            updateRecordDisplay();
        }

        function sendRecordToBot() {
            // –í —Ä–µ–∞–ª—å–Ω–æ—Å—Ç–∏ –∑–¥–µ—Å—å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å fetch() –∫ –≤–∞—à–µ–º—É API
            console.log("–û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Ä–µ–∫–æ—Ä–¥:", userRecord);
        }
    </script>
</body>
</html>
